.\"
.\" ldap_simple.(5)
.\"
.\" COPYRIGHT (c) 2008
.\" The Regents of the University of Michigan
.\" ALL RIGHTS RESERVED
.\" 
.\" Copyright (c) 2024 Jens Elkner <jel+nfs@cs.ovgu.de>
.\" 
.\" Permission is granted to use, copy, create derivative works
.\" and redistribute this software and such derivative works
.\" for any purpose, so long as the name of The University of
.\" Michigan is not used in any advertising or publicity
.\" pertaining to the use of distribution of this software
.\" without specific, written prior authorization.  If the
.\" above copyright notice or any other identification of the
.\" University of Michigan is included in any copy of any
.\" portion of this software, then the disclaimer below must
.\" also be included.
.\" 
.\" THIS SOFTWARE IS PROVIDED AS IS, WITHOUT REPRESENTATION
.\" FROM THE UNIVERSITY OF MICHIGAN AS TO ITS FITNESS FOR ANY
.\" PURPOSE, AND WITHOUT WARRANTY BY THE UNIVERSITY OF
.\" MICHIGAN OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING
.\" WITHOUT LIMITATION THE IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE
.\" REGENTS OF THE UNIVERSITY OF MICHIGAN SHALL NOT BE LIABLE
.\" FOR ANY DAMAGES, INCLUDING SPECIAL, INDIRECT, INCIDENTAL, OR
.\" CONSEQUENTIAL DAMAGES, WITH RESPECT TO ANY CLAIM ARISING
.\" OUT OF OR IN CONNECTION WITH THE USE OF THE SOFTWARE, EVEN
.\" IF IT HAS BEEN OR IS HEREAFTER ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGES.
.\"
.\" Tis file is based on nfs-utils/support/nfsidmap/idmapd.conf.5
.\"
.TH ldap_simple 5 "17 Oct 2024"
.SH NAME
ldap_simple \- a nfsidmap plugin with NFSv4 and LDAP support.
.SH DESCRIPTION
The \fBnfsidmap\fR(5) allows one to use several \fBTranslation Method\fRs
to map a NFSv4 name to a numerical ID and vice versa. \fBldap_simple\fR
is similar to the \fBumich_ldap\fR method (actually a fork of it), but skips
all kerboros overhead, allows one to lookup simple names instead
of \fIname\fB@\fIdomain\fR and does not query invalid attributes (minor
optimization). 

To make use of this plugin, in \fBidmapd.conf\fR(5) one needs to
add \fBldap_simple\fR to the \fBMethod\fR in the \fBTranslation\fR
section and add and configure the following section as needed:

.\" -------------------------------------------------------------------
.\" The [UMICH_SCHEMA] section
.\" -------------------------------------------------------------------
.\"
.SS "[UMICH_SCHEMA]"
.nf

.fi

.TP
.B LDAP_server
LDAP server name or address
(Required if using UMICH_LDAP)
.TP
.B LDAP_base
The default value for \fBLDAP_people_base\fR and \fBLDAP_group_base\fR.
.TP
.B LDAP_people_base
Absolute LDAP search base for people accounts.
(Default: The
.B LDAP_base
value)
.TP
.B LDAP_group_base
Absolute LDAP search base for group accounts.
(Default: The
.B LDAP_base
value)
.TP
.B LDAP_canonicalize_name
Whether or not to perform name canonicalization on the
name given as
.B LDAP_server
(Default: "true")
.TP
.B LDAP_follow_referrals
Whether or not to follow ldap referrals. (Default: "true")
.TP
.B LDAP_use_ssl
Set to "true" to enable SSL communication with the LDAP server.
(Default: "false")
.TP
.B LDAP_ca_cert
Location of a trusted CA certificate used when SSL is enabled
(Required if
.B LDAP_use_ssl
is true and
.B LDAP_tls_reqcert
is not set to never)
.TP
.B LDAP_tls_reqcert
Controls the LDAP server certificate validation behavior.
It can take the same values as ldap.conf(5)'s
.B TLS_REQCERT
tunable.
(Default: "hard")
.TP
.B LDAP_timeout_seconds
Number of seconds before timing out an LDAP request
(Default: 4)
.TP
.B LDAP_sasl_mech
SASL mechanism to be used for sasl authentication.  Required
if SASL auth is to be used (Default: None)
.TP
.B LDAP_sasl_realm
SASL realm to be used for sasl authentication. (Default: None)
.TP
.B LDAP_sasl_authcid
Authentication identity to be used for sasl authentication. (Default: None)
.TP
.B LDAP_sasl_authzid
Authorization identity to be used for sasl authentication. (Default: None)
.TP
.B LDAP_sasl_secprops
Cyrus SASL security properties. It can  the same values as ldap.conf(5)'s
sasl_secprops.
.TP
.B LDAP_sasl_canonicalize
Specifies whether the LDAP server hostname should be canonicalised.
If set to yes LDAP lib with do a reverse hostname lookup.
If this is not set the LDAP library's default will be used. (Default:
None)
.TP
.B NFSv4_person_objectclass
The object class name for people accounts in your local LDAP schema
(Default: NFSv4RemotePerson)
.TP
.B NFSv4_name_attr
Your local schema's attribute name to be used for NFSv4 user names
(Default: NFSv4Name)
.TP
.B NFSv4_uid_attr
Your local schema's attribute name to be used for uidNumber
(Default: uidNumber)
.TP
.B NFSv4_group_objectclass
The object class name for group accounts in your local LDAP schema
(Default: NFSv4RemoteGroup)
.TP
.B NFSv4_gid_attr
Your local schema's attribute name to be used for gidNumber.
(Default: gidNumber)
.TP
.B NFSv4_group_attr
Your local schema's attribute name to be used for NFSv4 group names.
(Default: NFSv4Name)
.TP
.B NFSv4_grouplist_filter
An optional search filter for determining group membership.
(No Default)
.TP
.B NFSv4_strip_domain
If \fBon\fR, the NFSv domain including the leading \fB@\fR gets removed
from the user and group name before an LDAP lookup gets fired. This way
one may use e.g. a simple posixAccount DB (when setting
NFSv4_person_objectclass\ =\ posixAccount, NFSv4_name_attr\ =\ uid,
NFSv4_group_objectclass\ =\ posixGroup, NFSv4_group_attr\ =\ cn) to
map \fIuser\fB@\fIdomain\fR to a proper UID
and \fIgroup\fB@\fIdomain\fR to a proper GID. Default: off
.TP
.B NFSv4_subtree
If \fBon\fR the scope of the LDAP search gets set to \fBsub\fR, i.e. the whole
subtree of the LDAP_people_base or LDAP_group_base gets searched for the user
or group name in question. Otherwise the search scope gets set to \fBone\fR
level. Default: on
.TP
All other entries get silently ignored.
.\"
.\" -------------------------------------------------------------------
.\" An Example
.\" -------------------------------------------------------------------
.\"
.SH EXAMPLES
An example
.I /etc/idmapd.conf
file:
.nf


[General]

Verbosity = 0
Domain = institute.example.org

[Mapping]

Nobody-User = nfsnobody
Nobody-Group = nfsnobody

[Translation]

Method = ldap_simple,nsswitch

[UMICH_SCHEMA]

LDAP_server = ldap.example.org
LDAP_people_base = ou=people,ou=institute,o=university
LDAP_group_base = ou=group,ou=institute,o=university
LDAP_use_ssl = true
LDAP_ca_cert = /var/ldap/ca-certs.pem
LDAP_user_dn = cn=unix,ou=roles,ou=institute,o=university
LDAP_passwd = your_role_password

# NFSv4_person_objectclass  = NFSv4RemotePerson
# NFSv4_name_attr = NFSv4Name
# NFSv4_uid_attr = uidNumber
NFSv4_person_objectclass  = posixAccount
NFSv4_name_attr = uid

# NFSv4_group_objectclass = NFSv4RemoteGroup
# NFSv4_group_attr = NFSv4Name
# NFSv4_gid_attr = gidNumber
NFSv4_group_objectclass = posixGroup
NFSv4_group_attr = cn

NFSv4_strip_domain = on
NFSv4_subtree = off

.fi
.\"
.\" -------------------------------------------------------------------
.\" Additional sections
.\" -------------------------------------------------------------------
.\"
.SH SEE ALSO
.BR nfsidmap (5)
.BR idmapd.conf (5)
.BR ldapsearch (1)
.\".SH COMPATIBILITY
.\".SH STANDARDS
.\".SH ACKNOWLEDGEMENTS
.\".SH AUTHORS
.\".SH HISTORY
.SH BUGS
Report bugs to via https://github.com/jelmd/ldap_simple/issues
.\".SH CAVEATS
